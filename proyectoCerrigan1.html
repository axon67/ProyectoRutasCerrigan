<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Fondo oscuro con estrellas fugaces ‚ú®</title>
<style>
  :root{
    --bg:#02030a;         /* negro azulado profundo */
    --glow:#ffd54f;       /* amarillo suave */
    --gold:#ffc107;       /* amarillo brillante */
  }
  html,body{height:100%; margin:0;}
  body{
    background:
      radial-gradient(1200px 800px at 70% 20%, rgba(255,213,79,.06), rgba(0,0,0,0)),
      radial-gradient(900px 600px at 25% 75%, rgba(255,193,7,.05), rgba(0,0,0,0)),
      var(--bg);
    overflow:hidden;
    color:#eaeaea;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }

  /* ---------- T√≠tulo en encabezado ---------- */
  header {
    position:fixed;
    top:20px;
    left:50%;
    transform:translateX(-50%);
    z-index:3;
    text-align:center;
  }
  header h3 {
    margin:0;
    font-size:1.4rem;
    font-weight:600;
    color:#fff;
    text-shadow: 
      0 0 6px rgba(255,255,255,0.9),
      0 0 14px rgba(200,200,255,0.75),
      0 0 22px rgba(255,213,79,0.55);
    letter-spacing:1px;
    margin-top:40px;
  }

  /* Sutil vi√±eta para aumentar contraste */
  body::after{
    content:"";
    position:fixed; inset:0;
    pointer-events:none;
    background: radial-gradient(1000px 1000px at 50% 50%, transparent 60%, rgba(0,0,0,.35) 100%);
    mix-blend-mode:multiply;
  }

  canvas{position:fixed; inset:0; width:100%; height:100%; display:block;}

  .hud{position:fixed; right:16px; top:16px; display:flex; gap:8px; align-items:center; z-index:2}
  .btn{
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.14);
    padding:10px 12px; border-radius:12px; cursor:pointer; user-select:none;
    backdrop-filter: blur(4px);
    transition: transform .15s ease, background .2s ease, border-color .2s ease;
    font-weight:600; letter-spacing:.2px; color:#f4f4f5;
  }
  .btn:hover{ transform: translateY(-1px); background:rgba(255,255,255,.10); }
  .toggle.on{ border-color: rgba(255,193,7,.8); box-shadow: 0 0 24px 4px rgba(255,193,7,.18) inset; }

  .brand{position:fixed; left:16px; bottom:16px; opacity:.55; font-size:12px; letter-spacing:.3px; z-index:1}

  /* Imagen central */
  .centerpiece{position:fixed; inset:0; display:grid; place-items:center; z-index:1; pointer-events:none}
  .centerpiece img{width:min(70vmin, 420px); height:auto; filter: drop-shadow(0 0 24px rgba(255,193,7,.35)) drop-shadow(0 0 64px rgba(255,193,7,.08)); transition: opacity .6s ease}
  .centerpiece img.is-fading{opacity:0}

  /* Bot√≥n circular de audio (play/mute) */
  .audioBtn {
    position: fixed;
    left: 50%;
    bottom: 43px; /* subido 15px */
    transform: translateX(-50%);
    z-index: 4;
    width: 64px; height: 64px;
    border-radius: 50%;
    display: grid; place-items: center;
    cursor: pointer; user-select: none;
    background: radial-gradient(90px 90px at 50% 45%, rgba(255,255,200,0.35), rgba(0,0,0,0.45));
    border: 1px solid rgba(255,255,255,0.65);
    box-shadow: 
      0 0 20px rgba(255,255,180,0.55), 
      0 0 40px rgba(200,200,255,0.35), 
      inset 0 0 22px rgba(255,255,200,0.35);
    backdrop-filter: blur(8px);
    transition: transform 0.2s ease, box-shadow 0.3s ease;
  }
  .audioBtn:hover {
    transform: translateX(-50%) translateY(-2px);
    box-shadow: 
      0 0 28px rgba(255,255,220,0.75), 
      0 0 60px rgba(180,200,255,0.45), 
      inset 0 0 28px rgba(255,255,200,0.45);
  }
  .audioBtn svg {
    width: 28px; height: 28px;
    fill:#fff;
    filter: drop-shadow(0 0 8px rgba(255,255,220,0.75));
  }
  .audioBtn.muted{
    border-color: rgba(230,240,255,.95); 
    background: radial-gradient(90px 90px at 50% 45%, rgba(240,250,255,.75), rgba(0,0,0,.35)); 
    box-shadow: 
      0 0 32px rgba(220,235,255,.95), 
      0 0 70px rgba(200,225,255,.75), 
      inset 0 0 32px rgba(240,250,255,.65);
  }

  /* Responsive m√≥vil */
  @media (max-width: 640px){
    header h3{font-size:1.1rem;}
    .hud{right:12px; top:12px}
    .btn{padding:8px 10px; border-radius:10px}
    .centerpiece img{width:min(82vmin, 360px)}
    .audioBtn{bottom:28px; width:56px; height:56px}
    .brand{left:12px; bottom:76px; font-size:11px}
  }
</style>
</head>
<body>
  <!-- T√≠tulo en encabezado -->
  <header>
    <h3>‚ú® Micaela, t√∫ eres la flor m√°s linda de mi vida</h3>
  </header>

  <canvas id="sky"></canvas>

  <!-- Centro -->
  <div class="centerpiece">
    <img id="heroImage" src="" alt="Imagen central" loading="eager" />
  </div>

  <!-- Audio de fondo -->
  <audio id="backgroundMusic" loop autoplay playsinline preload="auto">
    <source src="https://dl.dropboxusercontent.com/scl/fi/xac2mz0t4homhkvkr1d5w/FLORES-AMARILLAS.mp3?rlkey=uush4yu80dlaz54tbfilgdnb5&st=d0wjojvs" type="audio/mpeg">
  </audio>

  <!-- Bot√≥n circular de audio -->
  <button id="audioBtn" class="audioBtn">
    <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
  </button>

  <div class="hud">
    <div id="toggleGlow" class="btn toggle">‚≠ê Boost amarillo</div>
    <div id="makeWish" class="btn">üå† Lanza una fugaz</div>
  </div>

  <div class="brand">Haz clic o toca para lanzar una estrella fugaz</div>

<script>
(() => {
  const canvas = document.getElementById('sky');
  const ctx = canvas.getContext('2d');
  let DPR = Math.max(1, Math.floor(window.devicePixelRatio || 1));
  let W = 0, H = 0;
  let stars = [], twinkles = [], comets = [];
  let lastTime = 0;
  let yellowBoost = false;

  function resize(){
    W = canvas.width  = Math.floor(innerWidth  * DPR);
    H = canvas.height = Math.floor(innerHeight * DPR);
  }
  window.addEventListener('resize', () => { DPR = Math.max(1, Math.floor(devicePixelRatio||1)); resize(); initStars(true); });
  resize();

  function rand(min,max){ return Math.random()*(max-min)+min; }

  // ---------- Estrellas est√°ticas + parpadeo ----------
  function initStars(keep=false){
    const targetCount = Math.floor((W*H)/(11000 * DPR));
    if(!keep){ stars = []; twinkles = []; }
    while(stars.length < targetCount){
      const x = Math.random()*W;
      const y = Math.random()*H;
      const r = rand(0.6, 1.6) * DPR;
      const tone = Math.random();
      const color = tone < 0.15 ? `rgba(255,193,7,${rand(.6,.9)})` : `rgba(${200+~~rand(0,55)},${210+~~rand(0,45)},255,${rand(.45,.9)})`;
      stars.push({x,y,r,color});
      if(Math.random()<0.45){
        twinkles.push({x,y,base:rand(.25,.9),spd:rand(0.8,1.6),phase:rand(0,Math.PI*2)});
      }
    }
  }
  initStars();

  // ---------- Cometas (estrellas fugaces) ----------
  function spawnComet(x,y,dir){
    if(x==null||y==null){ x = rand(-W*0.1, W*0.3); y = rand(-H*0.05, H*0.35); }
    if(dir==null){ dir = rand(Math.PI*0.15, Math.PI*0.35); }
    const speed = rand(650, 980) * DPR; // px/s
    const len   = rand(160, 260) * DPR;
    const life  = rand(950, 1400); // ms
    const width = rand(1.4, 2.2) * DPR;
    const hueShift = yellowBoost ? 1 : 0;
    comets.push({x,y,dir,speed,len,life,age:0,width,hueShift});
  }

  // Auto: cada 3 s
  setInterval(() => spawnComet(), 3000);

  // Interacci√≥n
  canvas.addEventListener('pointerdown', (e) => {
    const rect = canvas.getBoundingClientRect();
    const x = (e.clientX - rect.left) * DPR;
    const y = (e.clientY - rect.top) * DPR;
    const dir = rand(Math.PI*0.2, Math.PI*0.6);
    spawnComet(x,y,dir);
  });

  document.getElementById('makeWish').onclick = () => spawnComet();
  const toggle = document.getElementById('toggleGlow');
  toggle.onclick = () => { yellowBoost = !yellowBoost; toggle.classList.toggle('on', yellowBoost); };

  // ===== Audio: autoplay con m√∫ltiples rutas =====
  const audioEl = document.getElementById('backgroundMusic');
  const audioBtn = document.getElementById('audioBtn');

  function setIcon(state){
    let svg='';
    if(state==='play'){
      svg='<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M8 5v14l11-7z"/></svg>';
      audioBtn.classList.remove('muted');
    } else if(state==='speaker'){
      svg='<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 10v4h4l5 5V5L7 10H3zm12.5 2a4.5 4.5 0 0 0-2.25-3.9v7.8A4.5 4.5 0 0 0 15.5 12zM15.5 5a9 9 0 0 1 0 14c-1.1 0-2-.9-2-2 0-.3.07-.57.18-.82A7 7 0 0 0 20 12a7 7 0 0 0-6.32-4.18c-.11-.25-.18-.52-.18-.82 0-1.1.9-2 2-2z"/></svg>';
      audioBtn.classList.remove('muted');
    } else {
      svg='<svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M3 10v4h4l5 5V5L7 10H3zm13.59-3L15 8.59 17.41 11 15 13.41 16.59 15 19 12.59 21.41 15 23 13.41 20.59 11 23 8.59 21.41 7 19 9.41 16.59 7z"/></svg>';
      audioBtn.classList.add('muted');
    }
    audioBtn.innerHTML = svg;
  }
  setIcon('play');

  async function tryAutoplay(){
    try{
      audioEl.muted = false;
      await audioEl.play();           // 1) directo con sonido
      setIcon('speaker');
    }catch(e1){
      try{
        audioEl.muted = true;         // 2) arranca silenciado
        await audioEl.play();
        setTimeout(() => {            // intento de desmuteo inmediato
          try{ audioEl.muted = false; setIcon('speaker'); }catch(_){}
        }, 150);
      }catch(e2){
        // 3) √∫ltimo recurso: desbloquear en primer gesto
        const unlock = async () => {
          try{
            audioEl.muted = false;
            await audioEl.play();
            setIcon('speaker');
          }catch(_){}
          document.removeEventListener('pointerdown', unlock);
          document.removeEventListener('keydown', unlock);
        };
        document.addEventListener('pointerdown', unlock, {once:true});
        document.addEventListener('keydown', unlock, {once:true});
      }
    }
  }
  window.addEventListener('load', tryAutoplay);

  audioBtn.addEventListener('click', async () => {
    try{
      if(audioEl.paused){
        audioEl.muted = false;
        await audioEl.play();
        setIcon('speaker');
      } else {
        audioEl.muted = !audioEl.muted;
        setIcon(audioEl.muted ? 'muted' : 'speaker');
      }
    }catch{ setIcon('play'); }
  });

  audioEl.addEventListener('play', () => setIcon(audioEl.muted ? 'muted' : 'speaker'));
  audioEl.addEventListener('pause', () => setIcon('play'));
  audioEl.addEventListener('volumechange', () => setIcon(audioEl.muted ? 'muted' : 'speaker'));

  // ===== Slideshow de 4 im√°genes (cambia cada 10s) =====
  const hero = document.getElementById('heroImage');
  const imageList = [
    'https://github.com/axon67/ProyectoRutasCerrigan/blob/main/Img/rojo.gif?raw=true',
    'https://cdn.pixabay.com/animation/2024/04/05/15/10/15-10-39-863_512.gif',
    'https://cdn.pixabay.com/animation/2024/03/13/01/06/01-06-07-391_512.gif',
    'https://png.pngtree.com/png-clipart/20241110/original/pngtree-yellow-rose-bouquet-clipart-illustration-png-image_16826873.png'
    
  ].filter(Boolean);

  let imgIndex = 0;

  function swapTo(index){
    const nextSrc = imageList[index % imageList.length];
    if(!nextSrc) return;
    const preload = new Image();
    preload.onload = () => {
      hero.classList.add('is-fading');
      setTimeout(() => { hero.src = preload.src; hero.classList.remove('is-fading'); }, 160);
    };
    preload.src = nextSrc;
  }

  if(imageList.length){ swapTo(0); }
  setInterval(() => {
    if(imageList.length>1){ imgIndex = (imgIndex+1)%imageList.length; swapTo(imgIndex); }
  }, 10000);

  // ---------- Dibujo del cielo ----------
  function drawBackground(){
    const gx = ctx.createRadialGradient(W*0.72, H*0.18, 0, W*0.72, H*0.18, Math.max(W,H)*0.9);
    gx.addColorStop(0, 'rgba(255,193,7,0.04)');
    gx.addColorStop(1, 'rgba(0,0,0,0)');
    ctx.fillStyle = gx;
    ctx.fillRect(0,0,W,H);
  }

  function drawStars(t){
    for(const s of stars){
      ctx.beginPath();
      ctx.fillStyle = s.color;
      ctx.arc(s.x, s.y, s.r, 0, Math.PI*2);
      ctx.fill();

      const g = ctx.createRadialGradient(s.x,s.y,0, s.x,s.y, s.r*3.2);
      g.addColorStop(0, 'rgba(255,255,255,.25)');
      g.addColorStop(1, 'rgba(255,255,255,0)');
      ctx.fillStyle = g; ctx.beginPath(); ctx.arc(s.x,s.y, s.r*3.2, 0, Math.PI*2); ctx.fill();
    }

    for(const tw of twinkles){
      const a = tw.base + Math.sin(t*tw.spd + tw.phase)*0.35 + 0.35;
      ctx.globalAlpha = Math.max(0, Math.min(1, a));
      ctx.fillStyle = 'rgba(255,255,255,1)';
      ctx.fillRect(tw.x, tw.y, 1*DPR, 1*DPR);
      ctx.globalAlpha = 1;
    }
  }

  function drawComets(dt){
    for(let i=comets.length-1; i>=0; i--){
      const c = comets[i];
      c.age += dt;
      const k = c.age / c.life;
      if(k>=1){ comets.splice(i,1); continue; }
      const vx = Math.cos(c.dir)*c.speed * (dt/1000);
      const vy = Math.sin(c.dir)*c.speed * (dt/1000);
      c.x += vx; c.y += vy;

      const tail = c.len * (1 - k*0.65);
      const tx = c.x - Math.cos(c.dir)*tail;
      const ty = c.y - Math.sin(c.dir)*tail;

      ctx.save();
      ctx.globalCompositeOperation = 'lighter';

      const grad = ctx.createLinearGradient(c.x, c.y, tx, ty);
      const headCol = c.hueShift ? 'rgba(255,193,7,0.95)' : 'rgba(255,213,79,0.9)';
      grad.addColorStop(0, headCol);
      grad.addColorStop(0.2, 'rgba(255,193,7,0.55)');
      grad.addColorStop(1, 'rgba(255,193,7,0)');
      ctx.strokeStyle = grad;
      ctx.lineWidth = c.width;
      ctx.lineCap = 'round';
      ctx.beginPath();
      ctx.moveTo(tx, ty);
      ctx.lineTo(c.x, c.y);
      ctx.stroke();

      const spark = ctx.createRadialGradient(c.x, c.y, 0, c.x, c.y, 18*DPR);
      spark.addColorStop(0, 'rgba(255,241,118,0.9)');
      spark.addColorStop(0.5, 'rgba(255,213,79,0.65)');
      spark.addColorStop(1, 'rgba(255,193,7,0)');
      ctx.fillStyle = spark;
      ctx.beginPath();
      ctx.arc(c.x, c.y, 18*DPR, 0, Math.PI*2);
      ctx.fill();

      ctx.restore();
    }
  }

  function loop(t){
    if(!lastTime) lastTime = t; const dt = Math.min(48, t - lastTime); lastTime = t;
    ctx.fillStyle = 'rgba(2,3,10,0.34)';
    ctx.fillRect(0,0,W,H);

    drawBackground();
    drawStars(t*0.0025);
    drawComets(dt);

    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);
})();
</script>
</body>
</html>
